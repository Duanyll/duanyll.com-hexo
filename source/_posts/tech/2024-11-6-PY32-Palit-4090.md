---
title: 非常便宜的同德 4090 手办风扇灯光驱动板
tags:
  - 电子设计
  - py32
  - 嘉立创eda
repo: Duanyll/py32-palit-4090
cover: https://img.duanyll.com/img/20241106161005.png
description: 使用 PY32F002A 以超低成本点亮同德 4090 手办卡的风扇和灯光
---

{% link https://oshwhub.com/duanyll/py32-palit-driver %}

## 简介

近期咸鱼上有大量的无核心显存的 4090 手办卡，其中同德的 4090 钻石因为外观好看尤其抢手。同德 4090 分成带原装灯光和不带原装灯光的两种，带原装灯光的前几天 140 元包邮可以拿下。最近这批 4090 拆核心和显存的手法比较暴力，有很多电阻电容错位了，所以为了点亮风扇和灯光最好不要直接给主板上电。咸鱼上购买专门的风扇灯光转接线要 20 块钱左右，自己打一个驱动板要便宜得多。

本项目使用了 SOP-8 封装的 PY32F002A 单片机做主控，这是一款单价低于 0.5 元的 Cortex-M0 单片机，有 3KB RAM 和 20KB Flash，完全可以满足需要。PY32F002A 本身可以直接 5V 供电，所以板子上只需要这一个芯片就够了。

## 线序

实测的同德 40 系显卡风扇接口线序如下（排线端子上标有编号）：

| 编号 | 功能                                              |
| ---- | ------------------------------------------------- |
| 1    | 左右风扇测速，可不接                              |
| 2    | 左右风扇 PWM 调速，悬空则满速                     |
| 3    | GND                                               |
| 4    | 供电，额定电压 12V，5V 也可工作，故未设计升压电路 |
| 5    | 中间风扇测速，可不接                              |
| 6    | 中间风扇 PWM 调速，悬空则满速                     |

灯光线序如下（不同于标准 5V 三针 ARGB）：

| 编号 | 功能                                                 |
| ---- | ---------------------------------------------------- |
| 1    | GND                                                  |
| 2    | 5V 供电                                              |
| 3    | NC                                                   |
| 4    | WS2812B 数据输入，共 22 颗 LED，兼容 3.3V 和 5V 电平 |

## 功耗

实测 5V 供电下单独风扇最大功耗约 2.6W

![](https://img.duanyll.com/img/20241106155323.png)

灯光最大亮度白色常亮，功耗可达 9.8W

![](https://img.duanyll.com/img/20241106155445.png)

同时开启风扇和灯光功耗最多 12.2W

![](https://img.duanyll.com/img/20241106155528.png)

这个功耗超过了一般电脑 USB 接口的限制，最好使用充电头供电，使用电脑供电建议降低 LED 亮度。

## 烧录方式

为了节省 PCB 空间，两线 SWD 烧录接口藏到了 Type-C 的 SBU 引脚上，烧录时需要使用 Type-C 测试板从 Type-C 口引出 SWD 接口。调试器可以选用 WCH-LinkE，烧录时需要给 Type-C 接 3.3V 供电，如果接 5V 则不能识别（所以用不了 [这个神奇调试器了](./2024-9-1-STLink-SBU.md)），3.3V 供电由于电压过低风扇不转，LED 也不会工作，所以不会导致电脑 USB 接口过载。

接线时最好用万用表测一下 Type-C 测试板上 SWDIO 和 SWCLK 对应的引脚，不同的测试板引脚可能不一样。

![](https://img.duanyll.com/img/20241106160214.png)

## 固件使用说明

目前固件比较简单，所有功能都在 `main.c` 里面实现。代码仓库地址：[https://github.com/Duanyll/py32-palit-4090](https://github.com/Duanyll/py32-palit-4090)

固件功能如下：

- 按一下 FAN 按钮循环切换风扇转速，共 5 个档位包括停止风扇
- 按一下 LED 按钮循环切换灯光亮度，共 5 个档位包括关闭灯光
- 双击 LED 按钮循环切换灯光模式
  - 目前简单实现了彩虹和流星效果，以及七种颜色的常亮
  - 在 `main.c` 里面的 `APP_UpdateLed` 函数里面实现自己的灯光效果很容易
- 上电后默认风扇转一秒钟后停转，灯光为一档亮度彩虹效果，可自行修改代码调整默认效果

附件里提供一个编译好的 `elf` 固件，可以直接下载到板子上使用。

## 更多图片

{% swiper width:max effect:cards/coverflow %}

![> ](https://img.duanyll.com/img/20241106161005.png)

![> ](https://img.duanyll.com/img/20241106160940.png)

![> ](https://img.duanyll.com/img/20241106160953.png)

{% endswiper %}
